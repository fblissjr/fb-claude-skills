last updated: 2026-02-25

# skill-maintainer

Property-driven maintenance tooling for Claude Code skills. Checks happen at natural breakpoints (commit, skill use, on-demand) instead of requiring dedicated maintenance sessions.

This is **project-scoped tooling** -- it runs from within this repo. It is not a skill and cannot be installed as a plugin.

## how maintenance works

| Concern | Mechanism | Trigger |
|---------|-----------|---------|
| Spec compliance | Pre-commit git hook | Automatic on commit |
| Staleness awareness | PostToolUse hook on Skill tool | Automatic when any skill is used |
| Quality/budget/freshness | `quality_report.py` | On demand |
| Upstream change detection | `check_upstream.py` | On demand |
| Change history | `query_log.py` | On demand |

## scripts

All scripts run via `uv run` from the repo root:

| Script | Purpose |
|--------|---------|
| `scripts/quality_report.py` | Unified report: validation, token budget, last_verified age, description quality |
| `scripts/check_upstream.py` | Fetch Claude Code docs, compare hashes, report what changed |
| `scripts/check_freshness.py` | Check last_verified dates in SKILL.md frontmatter |
| `scripts/validate_skill.py` | Validate skills against Agent Skills spec + best practices |
| `scripts/measure_content.py` | Token budget measurement for all skills |
| `scripts/query_log.py` | Query the append-only changes log |

## hooks

### pre-commit (git)

`.git/hooks/pre-commit` validates any staged SKILL.md files with `skills-ref validate`. Blocks the commit if validation fails.

### PostToolUse (Claude Code)

`.claude/settings.json` configures a PostToolUse hook on the `Skill` tool. When any skill is invoked, `.claude/hooks/check-skill-freshness.sh` reads `metadata.last_verified` from the skill's SKILL.md. If >30 days old, prints a one-line staleness note. Non-blocking.

## state

- `state/upstream_hashes.json` -- page content hashes for upstream detection (auto-generated by check_upstream.py)
- `state/changes.jsonl` -- append-only audit log (written by quality_report.py and check_upstream.py)
- `metadata.last_verified` in each SKILL.md frontmatter -- date the skill was last reviewed

## conventions

- All SKILL.md files must include `metadata.last_verified: YYYY-MM-DD` in frontmatter
- Update `last_verified` when you review or modify a skill
- The pre-commit hook enforces Agent Skills spec compliance
- No DuckDB, no config file, no pipeline -- just scripts, hooks, and JSONL
